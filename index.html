<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Dashboard v5.0 (TG Edition)</title>

    <link id="favicon" rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>â³</text></svg>">
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <!-- Telegram SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        :root {
            --bg-color: #f8f9fa; --card-bg: #ffffff; --text-main: #1a1a1a;
            --text-sub: #6c757d; --radius: 20px; --accent: #6366f1;
        }
        @media (prefers-color-scheme: dark) {
            :root { --bg-color: #0d0e12; --card-bg: #1a1b23; --text-main: #f8f9fa; --text-sub: #a0a0ab; }
        }
        body {
            background-color: var(--bg-color); color: var(--text-main);
            font-family: 'Inter', -apple-system, sans-serif;
            margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center;
        }
        .container { width: 100%; max-width: 500px; display: none; }
        #auth-container { width: 100%; max-width: 400px; margin-top: 50px; }
        .floating-controls {
            position: fixed; bottom: 30px; right: 20px; z-index: 1000;
            display: none; flex-direction: column; gap: 10px;
        }
        .btn-round {
            width: 50px; height: 50px; border-radius: 50%; border: none;
            background: var(--accent); color: white; cursor: pointer;
            box-shadow: 0 8px 16px rgba(99, 102, 241, 0.3); font-size: 1.3rem;
            display: flex; align-items: center; justify-content: center;
        }
        header {
            text-align: center; padding: 40px 20px; border-radius: var(--radius);
            background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            color: white; margin-bottom: 25px; transition: background 2s ease-in-out;
        }
        .section-title { margin: 25px 0 12px 10px; font-size: 0.75rem; font-weight: 800; color: var(--text-sub); text-transform: uppercase; }
        .progress-card {
            background: var(--card-bg); padding: 18px; border-radius: var(--radius);
            margin-bottom: 12px; border: 1px solid rgba(0,0,0,0.05); cursor: pointer; position: relative;
        }
        .info { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .title { font-weight: 700; display: flex; align-items: center; gap: 8px; font-size: 0.95rem; }
        .percentage { font-family: monospace; font-size: 0.85rem; opacity: 0.7; }
        .bar-container { height: 8px; background: rgba(0,0,0,0.08); border-radius: 4px; overflow: hidden; }
        .bar-fill { height: 100%; width: 0%; transition: width 1s ease; }
        .add-box, .auth-box {
            background: var(--card-bg); padding: 25px; border-radius: var(--radius);
            display: flex; flex-direction: column; gap: 15px; border: 1px solid rgba(0,0,0,0.05);
        }
        input {
            width: 100%; padding: 12px; border-radius: 12px; border: 1px solid rgba(0,0,0,0.1);
            background: var(--bg-color); color: var(--text-main); font-size: 1rem; outline: none;
        }
        .color-picker-wrapper { display: flex; align-items: center; gap: 15px; margin-top: 5px; }
        #goalColor { opacity: 0; position: absolute; width: 40px; height: 40px; cursor: pointer; }
        .color-circle {
            width: 44px; height: 44px; border-radius: 50%; border: 3px solid white; 
            box-shadow: 0 0 0 2px rgba(0,0,0,0.1); cursor: pointer; background-color: #6366f1;
        }
        button {
            background: var(--accent); color: white; border: none; padding: 16px;
            border-radius: 14px; font-weight: 700; cursor: pointer; font-size: 1rem;
        }
        .logout-btn { background: #ef4444; margin-top: 20px; padding: 10px; font-size: 0.8rem; width: 100%; color: white; border-radius: 12px; border: none; cursor: pointer; }
        #toast {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            background: #1a1a1a; color: white; padding: 12px 24px;
            border-radius: 50px; opacity: 0; transition: 0.3s; z-index: 10000;
        }
        body.zen-mode header, body.zen-mode .add-box, body.zen-mode .section-title, body.zen-mode .del-btn, body.zen-mode .logout-btn {
            display: none !important;
        }
        .del-btn { color: #ef4444; border: none; background: none; cursor: pointer; font-size: 1.1rem; }
        
        /* Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Telegram */
        #tg-status { font-size: 0.65rem; margin-top: 5px; color: var(--text-sub); text-align: center; }
    </style>
</head>
<body>

<div id="toast"></div>

<div id="auth-container">
    <header><h1>Dash Login</h1><p>Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹ ÑĞ²Ğ¾Ğ¸ Ñ†ĞµĞ»Ğ¸</p></header>
    <div class="auth-box">
        <input type="email" id="auth-email" placeholder="Email">
        <input type="password" id="auth-password" placeholder="ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ">
        <button onclick="handleAuth('login')">Ğ’Ğ¾Ğ¹Ñ‚Ğ¸</button>
        <button onclick="handleAuth('signup')" style="background: none; color: var(--text-sub); font-size: 0.8rem;">ĞĞµÑ‚ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ°? Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ</button>
    </div>
</div>

<div class="container" id="main-app">
    <div class="floating-controls" id="controls">
        <button class="btn-round" onclick="toggleZen()">ğŸ§˜</button>
        <button class="btn-round" onclick="shareReport()" style="background: #10b981;">ğŸ”—</button>
    </div>

    <header id="dynamic-header">
        <h1 id="greeting" style="margin:0; font-size: 2rem;">ĞŸÑ€Ğ¸Ğ²ĞµÑ‚</h1>
        <p id="current-date" style="margin:5px 0 0; opacity: 0.8;"></p>
    </header>

    <div id="base-tasks"></div>
    <div class="section-title">ĞœĞ¾Ğ¸ Ñ†ĞµĞ»Ğ¸</div>
    <div id="custom-tasks"></div>

    <div class="add-box">
        <div style="display:flex; flex-direction:column; gap:5px;"><label style="font-size:0.7rem; font-weight:bold; color:var(--text-sub)">ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ</label><input type="text" id="goalName"></div>
        <div style="display:flex; flex-direction:column; gap:5px;"><label style="font-size:0.7rem; font-weight:bold; color:var(--text-sub)">ĞĞ°Ñ‡Ğ°Ğ»Ğ¾</label><input type="date" id="startDate"></div>
        <div style="display:flex; flex-direction:column; gap:5px;"><label style="font-size:0.7rem; font-weight:bold; color:var(--text-sub)">Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ğµ</label><input type="date" id="endDate"></div>
        <div class="color-picker-wrapper">
            <input type="color" id="goalColor" value="#6366f1" oninput="updateCircleColor(this.value)">
            <div class="color-circle" id="colorIndicator" onclick="document.getElementById('goalColor').click()"></div>
            <span style="font-size: 0.8rem; color: var(--text-sub);">Ğ¦Ğ²ĞµÑ‚ Ğ¿Ğ¾Ğ»Ğ¾ÑĞºĞ¸</span>
        </div>
        <button onclick="addGoal()">Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¸ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ¸Ñ‚ÑŒ</button>
        <div id="tg-status">Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ¾Ñ‚ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹</div>
    </div>
    
    <button class="logout-btn" onclick="handleLogout()">Ğ’Ñ‹Ğ¹Ñ‚Ğ¸ Ğ¸Ğ· Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ°</button>
</div>

<script>
    const SUPABASE_URL = 'https://pknlgkatbzoqemyyomnr.supabase.co';
    const SUPABASE_KEY = 'sb_publishable_my49hMN7vJp2xXfqxiQ90Q_7Zg708ua';
    const CF_WORKER_URL = 'https://time-dashboard.v2178335.workers.dev'; // Ğ—ĞĞœĞ•ĞĞ˜Ğ¢Ğ• ĞĞ Ğ¡Ğ’ĞĞ™ URL
    
    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
    const tg = window.Telegram.WebApp;

    let userGoals = [];
    let currentUser = null;
    let currentUserTgId = null;
    let showAsCountdown = false;
    let currentFaviconHour = -1;

    const baseItems = [
        { id: 'day', label: 'Ğ”ĞµĞ½ÑŒ', unit: 'day', color: '#6366f1' },
        { id: 'month', label: 'ĞœĞµÑÑÑ†', unit: 'month', color: '#ec4899' },
        { id: 'year', label: 'Ğ“Ğ¾Ğ´', unit: 'year', color: '#22c55e' }
    ];

    // --- ĞĞ’Ğ¢ĞĞ Ğ˜Ğ—ĞĞ¦Ğ˜Ğ¯ Ğ˜ TG ---
    async function handleAuth(type) {
        const email = document.getElementById('auth-email').value;
        const password = document.getElementById('auth-password').value;
        if(!email || !password) return showToast("Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸ Ğ¿Ğ¾Ğ»Ñ!");

        const { data, error } = type === 'login' 
            ? await supabaseClient.auth.signInWithPassword({ email, password })
            : await supabaseClient.auth.signUp({ email, password });

        if (error) showToast(error.message);
    }

    async function handleLogout() { await supabaseClient.auth.signOut(); }

    supabaseClient.auth.onAuthStateChange((event, session) => {
        currentUser = session?.user || null;
        if (currentUser) {
            document.getElementById('auth-container').style.display = 'none';
            document.getElementById('main-app').style.display = 'block';
            document.getElementById('controls').style.display = 'flex';
            initApp();
        } else {
            document.getElementById('auth-container').style.display = 'block';
            document.getElementById('main-app').style.display = 'none';
            document.getElementById('controls').style.display = 'none';
        }
    });

    async function initApp() {
        await autoBindTelegram();
        fetchGoals();
        tg.expand(); // Ğ Ğ°Ğ·Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Mini App
    }

    async function autoBindTelegram() {
        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ Ğ² Ğ±Ğ°Ğ·Ğµ
        const { data: profile } = await supabaseClient.from('profiles').select('telegram_id').eq('id', currentUser.id).single();
        
        if (profile && profile.telegram_id) {
            currentUserTgId = profile.telegram_id;
            document.getElementById('tg-status').innerText = "ğŸ”” Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹ (Telegram)";
        }

        // Ğ•ÑĞ»Ğ¸ Ğ·Ğ°ÑˆĞ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Ğ¢Ğ“ Ğ¸ ID ĞµÑ‰Ğµ Ğ½ĞµÑ‚ Ğ² Ğ±Ğ°Ğ·Ğµ Ğ¸Ğ»Ğ¸ Ğ¾Ğ½ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ğ»ÑÑ
        if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
            const newTgId = tg.initDataUnsafe.user.id.toString();
            if (newTgId !== currentUserTgId) {
                const { error } = await supabaseClient.from('profiles').upsert({ id: currentUser.id, telegram_id: newTgId });
                if (!error) {
                    currentUserTgId = newTgId;
                    document.getElementById('tg-status').innerText = "ğŸ”” Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¸Ğ²ÑĞ·Ğ°Ğ½Ñ‹!";
                }
            }
            document.getElementById('greeting').innerText = `ĞŸÑ€Ğ¸Ğ²ĞµÑ‚, ${tg.initDataUnsafe.user.first_name || 'Ğ´Ñ€ÑƒĞ³'}`;
        }
    }

    // --- Ğ ĞĞ‘ĞĞ¢Ğ Ğ¡ Ğ‘ĞĞ—ĞĞ™ ---
    async function fetchGoals() {
        const { data, error } = await supabaseClient.from('goals').select('*');
        if (!error) { userGoals = data; renderGoals(); }
    }

    async function addGoal() {
        const name = document.getElementById('goalName').value;
        const start = document.getElementById('startDate').value || new Date().toISOString().split('T')[0];
        const end = document.getElementById('endDate').value;
        const color = document.getElementById('goalColor').value;
        
        if (!name || !end) return showToast("Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ´Ğ°Ñ‚Ñƒ!");

        const { data, error } = await supabaseClient.from('goals').insert([{ name, start, end, color, user_id: currentUser.id }]).select();

        if (!error) {
            userGoals.push(data[0]);
            renderGoals();

            // ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ² Telegram Ñ‡ĞµÑ€ĞµĞ· Cloudflare
            if (currentUserTgId) {
                fetch(CF_WORKER_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ chat_id: currentUserTgId, name, end })
                }).catch(e => console.log("Worker error"));
            }

            document.getElementById('goalName').value = '';
            showToast("Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¾!");
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.8 } });
        } else {
            showToast("ĞÑˆĞ¸Ğ±ĞºĞ°: " + error.message);
        }
    }

async function deleteGoal(id, e) {
    e.stopPropagation();
    // ĞĞ°Ñ…Ğ¾Ğ´Ğ¸Ğ¼ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ†ĞµĞ»Ğ¸ Ğ¿ĞµÑ€ĞµĞ´ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸ĞµĞ¼
    const goalToDelete = userGoals.find(g => g.id === id);
    const goalName = goalToDelete ? goalToDelete.name : "Ğ‘ĞµĞ· Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ";

    const { error } = await supabaseClient.from('goals').delete().eq('id', id);
    if (!error) {
        // ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ğ± ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğ¸
        if (currentUserTgId) {
            fetch(CF_WORKER_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    chat_id: currentUserTgId, 
                    name: goalName, 
                    type: 'delete' 
                })
            }).catch(e => console.log("Ğ‘Ğ¾Ñ‚ Ğ½Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¸Ğ»"));
        }

        userGoals = userGoals.filter(g => g.id !== id);
        renderGoals();
        showToast("Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¾");
    }
}

    // --- Ğ’Ğ˜Ğ—Ğ£ĞĞ› (Ğ‘Ğ•Ğ— Ğ˜Ğ—ĞœĞ•ĞĞ•ĞĞ˜Ğ™) ---
    function renderGoals() {
        const container = document.getElementById('custom-tasks');
        container.innerHTML = '';
        userGoals.forEach(g => {
            container.innerHTML += `
                <div class="progress-card" onclick="toggleView()">
                    <div class="info">
                        <span class="title">${g.name} <button class="del-btn" onclick="deleteGoal(${g.id}, event)">âœ•</button></span>
                        <span class="percentage" id="perc-${g.id}">0%</span>
                    </div>
                    <div class="bar-container">
                        <div class="bar-fill" style="background: ${g.color}" id="bar-${g.id}"></div>
                    </div>
                </div>`;
        });
    }

    function updateCircleColor(val) { document.getElementById('colorIndicator').style.backgroundColor = val; }
    function toggleZen() { document.body.classList.toggle('zen-mode'); }
    function showToast(msg) {
        const t = document.getElementById('toast');
        t.innerText = msg; t.style.opacity = '1';
        setTimeout(() => t.style.opacity = '0', 2500);
    }

    function updateFavicon(hour) {
        if (hour === currentFaviconHour) return;
        currentFaviconHour = hour;
        const clocks = ['ğŸ•›','ğŸ•','ğŸ•‘','ğŸ•’','ğŸ•“','ğŸ•”','ğŸ••','ğŸ•–','ğŸ•—','ğŸ•˜','ğŸ•™','ğŸ•š','ğŸ•›','ğŸ•','ğŸ•‘','ğŸ•’','ğŸ•“','ğŸ•”','ğŸ••','ğŸ•–','ğŸ•—','ğŸ•˜','ğŸ•™','ğŸ•š'];
        const favicon = document.getElementById('favicon');
        favicon.href = `data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>${clocks[hour] || 'â³'}</text></svg>`;
    }

    function toggleView() {
        showAsCountdown = !showAsCountdown;
        showToast(showAsCountdown ? "Ğ ĞµĞ¶Ğ¸Ğ¼: Ğ”Ğ½Ğ¸" : "Ğ ĞµĞ¶Ğ¸Ğ¼: ĞŸÑ€Ğ¾Ñ†ĞµĞ½Ñ‚Ñ‹");
    }

    function update() {
        const now = new Date();
        const hour = now.getHours();
        updateFavicon(hour);

        const header = document.getElementById('dynamic-header');
        const greeting = document.getElementById('greeting');
        let gradient, text;

        if (hour >= 5 && hour < 11) { gradient = "linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)"; text = "Ğ”Ğ¾Ğ±Ñ€Ğ¾Ğµ ÑƒÑ‚Ñ€Ğ¾"; }
        else if (hour >= 11 && hour < 18) { gradient = "linear-gradient(135deg, #6366f1 0%, #a855f7 100%)"; text = "Ğ”Ğ¾Ğ±Ñ€Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ"; }
        else if (hour >= 18 && hour < 22) { gradient = "linear-gradient(135deg, #fa709a 0%, #fee140 100%)"; text = "Ğ”Ğ¾Ğ±Ñ€Ñ‹Ğ¹ Ğ²ĞµÑ‡ĞµÑ€"; }
        else { gradient = "linear-gradient(135deg, #1e3c72 0%, #2a5298 100%)"; text = "Ğ”Ğ¾Ğ±Ñ€Ğ¾Ğ¹ Ğ½Ğ¾Ñ‡Ğ¸"; }

        if (greeting && !tg.initDataUnsafe.user && greeting.innerText !== text) {
            header.style.background = gradient;
            greeting.innerText = text;
        }
        
        baseItems.forEach(item => {
            let prog = 0, label = "";
            if (item.unit === 'day') {
                prog = ((now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds()) / 86400) * 100;
                label = showAsCountdown ? (23 - now.getHours()) + " Ñ‡" : prog.toFixed(2) + "%";
            } else if (item.unit === 'month') {
                const total = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();
                prog = (now.getDate() / total) * 100;
                label = showAsCountdown ? (total - now.getDate()) + " Ğ´Ğ½" : prog.toFixed(2) + "%";
            } else if (item.unit === 'year') {
                const start = new Date(now.getFullYear(), 0, 1);
                const end = new Date(now.getFullYear() + 1, 0, 1);
                prog = ((now - start) / (end - start)) * 100;
                label = showAsCountdown ? Math.floor((end - now)/86400000) + " Ğ´Ğ½" : prog.toFixed(2) + "%";
            }
            const bar = document.getElementById(`bar-${item.id}`);
            const perc = document.getElementById(`perc-${item.id}`);
            if(bar) bar.style.width = prog + "%";
            if(perc) perc.innerText = label;
        });

        userGoals.forEach(g => {
            const startDate = new Date(g.start);
            const endDate = new Date(g.end); endDate.setHours(23,59,59);
            let prog = now >= endDate ? 100 : Math.max(0, ((now - startDate) / (endDate - startDate)) * 100);
            const bar = document.getElementById(`bar-${g.id}`);
            const perc = document.getElementById(`perc-${g.id}`);
            if (bar && perc) {
                bar.style.width = prog + "%";
                perc.innerText = prog >= 100 ? "Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾!" : (showAsCountdown ? Math.ceil((endDate - now)/86400000) + " Ğ´Ğ½" : prog.toFixed(1) + "%");
            }
        });
        requestAnimationFrame(update);
    }

    function shareReport() {
        const now = new Date();
        let reportText = `ğŸ“Š ĞœĞĞ™ ĞĞ¢Ğ§Ğ•Ğ¢ (${now.toLocaleDateString()})\n---------------------------\nğŸ—“ Ğ“Ğ¾Ğ´: ${document.getElementById('perc-year').innerText}\n`;
        userGoals.forEach(g => {
            const end = new Date(g.end); end.setHours(23,59,59);
            let prog = now >= end ? 100 : Math.max(0, ((now - new Date(g.start)) / (end - new Date(g.start))) * 100);
            reportText += `â€¢ ${g.name}: ${prog >= 100 ? "âœ…" : prog.toFixed(1) + "%"}\n`;
        });
        navigator.clipboard.writeText(reportText + `\nğŸš€ Ğ¡Ğ´ĞµĞ»Ğ°Ğ½Ğ¾ Ğ² Time Dash`).then(() => {
            showToast("ĞÑ‚Ñ‡ĞµÑ‚ ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½!");
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
        });
    }

    const baseContainer = document.getElementById('base-tasks');
    baseItems.forEach(item => {
        baseContainer.innerHTML += `
            <div class="progress-card" onclick="toggleView()">
                <div class="info">
                    <span class="title">${item.label}</span>
                    <span class="percentage" id="perc-${item.id}">0%</span>
                </div>
                <div class="bar-container">
                    <div class="bar-fill" style="background: ${item.color}" id="bar-${item.id}"></div>
                </div>
            </div>`;
    });

    document.getElementById('current-date').innerText = new Date().toLocaleDateString('ru-RU', { day: 'numeric', month: 'long', year: 'numeric' });
    update();
</script>
</body>
</html>
